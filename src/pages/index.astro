---
import { SITE_TITLE, SITE_DESCRIPTION, SITE_AVATAR } from "../consts";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Body from "../components/Body.astro";
import TopBar from "../components/TopBar.astro";
import HeroSection from "../components/HeroSection.astro";
import CustomCursors from "../components/CustomCursors.astro";
import LoadingOverlay from "../components/LoadingOverlay.astro";

const works = Object.values(
  import.meta.glob("./works/*.md", { eager: true })
).sort(
  (a: any, b: any) =>
    new Date(b.frontmatter.createdAt).valueOf() -
    new Date(a.frontmatter.createdAt).valueOf()
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <Body>
    <!-- Background image + overlay -->
    <div class="fixed inset-0 z-0">
      <img src="/assets/background.png" class="w-full h-full object-cover" />
      <div class="absolute inset-0 bg-black/20"></div>
    </div>

    <!-- Main content -->
    <main class="relative h-screen z-10 flex items-center justify-center">
      <div
        id="card"
        class="bg-white/30 dark:bg-gray-900/30 backdrop-blur-md rounded-lg p-6 md:p-12 max-w-3xl w-full mx-4 relative overflow-hidden"
      >
        <section class="space-y-8 relative z-10">
          <TopBar />
          <HeroSection
            title={SITE_TITLE}
            description={SITE_DESCRIPTION}
            avatar={SITE_AVATAR}
            worksCount={works.length}
          />
        </section>
        <div id="glow" class="absolute inset-0 pointer-events-none"></div>
      </div>
    </main>
  </Body>
</html>

<script>
  const glow = document.getElementById("glow");
  document.addEventListener("mousemove", (e) => {
    if (!glow) return;
    const rect = glow.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    glow.style.background = `radial-gradient(350px circle at ${x}px ${y}px, rgba(139,92,246,0.5), transparent 50%)`;
  });
</script>